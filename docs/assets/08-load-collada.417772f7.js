import{aQ as Nn,aR as An,aA as Tn,aN as _n,aB as En,V as ae,ay as ie,f as ot,S as mt,s as xn,C as Me,aS as Cn,Q as vn,aT as Ne,aU as rt,aV as ct,aW as Ln,i as In,aa as lt,d as Rn,D as Sn,a6 as Gn,P as Oe,O as Mn,a as bt,j as On,o as gt,q as jn,m as qn,K as ce,n as dt,aP as Ge,aX as Pn,X as Bn,aY as Hn,g as Un,J as zn,aM as Fn,R as ve,x as ut,aZ as Vn,G as Dn,W as Kn,A as Wn,b as Jn}from"./stats.module.1062c650.js";import{O as Yn}from"./OrbitControls.3104130d.js";import{d as Xn,g as ft,h as Zn,c as Qn,f as ht,o as $n}from"./index.6c251f58.js";const es="/learning-threejs/assets/elf.14ce50b8.dae";class pt extends Nn{constructor(F){super(F)}parse(F){function ee(h){switch(h.image_type){case le:case z:(h.colormap_length>256||h.colormap_size!==24||h.colormap_type!==1)&&console.error("THREE.TGALoader: Invalid type colormap data for indexed type.");break;case H:case V:case re:case de:h.colormap_type&&console.error("THREE.TGALoader: Invalid type colormap data for colormap type.");break;case ye:console.error("THREE.TGALoader: No data.");default:console.error('THREE.TGALoader: Invalid type "%s".',h.image_type)}(h.width<=0||h.height<=0)&&console.error("THREE.TGALoader: Invalid image size."),h.pixel_size!==8&&h.pixel_size!==16&&h.pixel_size!==24&&h.pixel_size!==32&&console.error('THREE.TGALoader: Invalid pixel size "%s".',h.pixel_size)}function O(h,P,S,L,B){let C,I;const A=S.pixel_size>>3,N=S.width*S.height*A;if(P&&(I=B.subarray(L,L+=S.colormap_length*(S.colormap_size>>3))),h){C=new Uint8Array(N);let y,u,k,G=0;const Z=new Uint8Array(A);for(;G<N;)if(y=B[L++],u=(y&127)+1,y&128){for(k=0;k<A;++k)Z[k]=B[L++];for(k=0;k<u;++k)C.set(Z,G+k*A);G+=A*u}else{for(u*=A,k=0;k<u;++k)C[G+k]=B[L++];G+=u}}else C=B.subarray(L,L+=P?S.width*S.height:N);return{pixel_data:C,palettes:I}}function W(h,P,S,L,B,C,I,A,N){const y=N;let u,k=0,G,Z;const pe=q.width;for(Z=P;Z!==L;Z+=S)for(G=B;G!==I;G+=C,k++)u=A[k],h[(G+pe*Z)*4+3]=255,h[(G+pe*Z)*4+2]=y[u*3+0],h[(G+pe*Z)*4+1]=y[u*3+1],h[(G+pe*Z)*4+0]=y[u*3+2];return h}function x(h,P,S,L,B,C,I,A){let N,y=0,u,k;const G=q.width;for(k=P;k!==L;k+=S)for(u=B;u!==I;u+=C,y+=2)N=A[y+0]+(A[y+1]<<8),h[(u+G*k)*4+0]=(N&31744)>>7,h[(u+G*k)*4+1]=(N&992)>>2,h[(u+G*k)*4+2]=(N&31)<<3,h[(u+G*k)*4+3]=N&32768?0:255;return h}function J(h,P,S,L,B,C,I,A){let N=0,y,u;const k=q.width;for(u=P;u!==L;u+=S)for(y=B;y!==I;y+=C,N+=3)h[(y+k*u)*4+3]=255,h[(y+k*u)*4+2]=A[N+0],h[(y+k*u)*4+1]=A[N+1],h[(y+k*u)*4+0]=A[N+2];return h}function T(h,P,S,L,B,C,I,A){let N=0,y,u;const k=q.width;for(u=P;u!==L;u+=S)for(y=B;y!==I;y+=C,N+=4)h[(y+k*u)*4+2]=A[N+0],h[(y+k*u)*4+1]=A[N+1],h[(y+k*u)*4+0]=A[N+2],h[(y+k*u)*4+3]=A[N+3];return h}function Q(h,P,S,L,B,C,I,A){let N,y=0,u,k;const G=q.width;for(k=P;k!==L;k+=S)for(u=B;u!==I;u+=C,y++)N=A[y],h[(u+G*k)*4+0]=N,h[(u+G*k)*4+1]=N,h[(u+G*k)*4+2]=N,h[(u+G*k)*4+3]=255;return h}function D(h,P,S,L,B,C,I,A){let N=0,y,u;const k=q.width;for(u=P;u!==L;u+=S)for(y=B;y!==I;y+=C,N+=2)h[(y+k*u)*4+0]=A[N+0],h[(y+k*u)*4+1]=A[N+0],h[(y+k*u)*4+2]=A[N+0],h[(y+k*u)*4+3]=A[N+1];return h}function te(h,P,S,L,B){let C,I,A,N,y,u;switch((q.flags&ue)>>fe){default:case Ae:C=0,A=1,y=P,I=0,N=1,u=S;break;case Y:C=0,A=1,y=P,I=S-1,N=-1,u=-1;break;case oe:C=P-1,A=-1,y=-1,I=0,N=1,u=S;break;case ne:C=P-1,A=-1,y=-1,I=S-1,N=-1,u=-1;break}if(we)switch(q.pixel_size){case 8:Q(h,I,N,u,C,A,y,L);break;case 16:D(h,I,N,u,C,A,y,L);break;default:console.error("THREE.TGALoader: Format not supported.");break}else switch(q.pixel_size){case 8:W(h,I,N,u,C,A,y,L,B);break;case 16:x(h,I,N,u,C,A,y,L);break;case 24:J(h,I,N,u,C,A,y,L);break;case 32:T(h,I,N,u,C,A,y,L);break;default:console.error("THREE.TGALoader: Format not supported.");break}return h}const ye=0,le=1,H=2,V=3,z=9,re=10,de=11,ue=48,fe=4,Y=0,ne=1,Ae=2,oe=3;F.length<19&&console.error("THREE.TGALoader: Not enough data to contain header.");let R=0;const M=new Uint8Array(F),q={id_length:M[R++],colormap_type:M[R++],image_type:M[R++],colormap_index:M[R++]|M[R++]<<8,colormap_length:M[R++]|M[R++]<<8,colormap_size:M[R++],origin:[M[R++]|M[R++]<<8,M[R++]|M[R++]<<8],width:M[R++]|M[R++]<<8,height:M[R++]|M[R++]<<8,pixel_size:M[R++],flags:M[R++]};ee(q),q.id_length+R>F.length&&console.error("THREE.TGALoader: No data."),R+=q.id_length;let he=!1,ke=!1,we=!1;switch(q.image_type){case z:he=!0,ke=!0;break;case le:ke=!0;break;case re:he=!0;break;case H:break;case de:he=!0,we=!0;break;case V:we=!0;break}const Te=new Uint8Array(q.width*q.height*4),_e=O(he,ke,q,R,M);return te(Te,q.width,q.height,_e.pixel_data,_e.palettes),{data:Te,width:q.width,height:q.height,flipY:!0,generateMipmaps:!0,minFilter:An}}}class ts extends Tn{constructor(F){super(F)}load(F,ee,O,W){const x=this,J=x.path===""?_n.extractUrlBase(F):x.path,T=new En(x.manager);T.setPath(x.path),T.setRequestHeader(x.requestHeader),T.setWithCredentials(x.withCredentials),T.load(F,function(Q){try{ee(x.parse(Q,J))}catch(D){W?W(D):console.error(D),x.manager.itemError(F)}},O,W)}parse(F,ee){function O(t,e){const s=[],n=t.childNodes;for(let i=0,a=n.length;i<a;i++){const o=n[i];o.nodeName===e&&s.push(o)}return s}function W(t){if(t.length===0)return[];const e=t.trim().split(/\s+/),s=new Array(e.length);for(let n=0,i=e.length;n<i;n++)s[n]=e[n];return s}function x(t){if(t.length===0)return[];const e=t.trim().split(/\s+/),s=new Array(e.length);for(let n=0,i=e.length;n<i;n++)s[n]=parseFloat(e[n]);return s}function J(t){if(t.length===0)return[];const e=t.trim().split(/\s+/),s=new Array(e.length);for(let n=0,i=e.length;n<i;n++)s[n]=parseInt(e[n]);return s}function T(t){return t.substring(1)}function Q(){return"three_default_"+kn++}function D(t){return Object.keys(t).length===0}function te(t){return{unit:ye(O(t,"unit")[0]),upAxis:le(O(t,"up_axis")[0])}}function ye(t){return t!==void 0&&t.hasAttribute("meter")===!0?parseFloat(t.getAttribute("meter")):1}function le(t){return t!==void 0?t.textContent:"Y_UP"}function H(t,e,s,n){const i=O(t,e)[0];if(i!==void 0){const a=O(i,s);for(let o=0;o<a.length;o++)n(a[o])}}function V(t,e){for(const s in t){const n=t[s];n.build=e(t[s])}}function z(t,e){return t.build!==void 0||(t.build=e(t)),t.build}function re(t){const e={sources:{},samplers:{},channels:{}};let s=!1;for(let n=0,i=t.childNodes.length;n<i;n++){const a=t.childNodes[n];if(a.nodeType!==1)continue;let o;switch(a.nodeName){case"source":o=a.getAttribute("id"),e.sources[o]=Le(a);break;case"sampler":o=a.getAttribute("id"),e.samplers[o]=de(a);break;case"channel":o=a.getAttribute("target"),e.channels[o]=ue(a);break;case"animation":re(a),s=!0;break;default:console.log(a)}}s===!1&&(w.animations[t.getAttribute("id")||Ne.generateUUID()]=e)}function de(t){const e={inputs:{}};for(let s=0,n=t.childNodes.length;s<n;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"input":const a=T(i.getAttribute("source")),o=i.getAttribute("semantic");e.inputs[o]=a;break}}return e}function ue(t){const e={};let n=t.getAttribute("target").split("/");const i=n.shift();let a=n.shift();const o=a.indexOf("(")!==-1,l=a.indexOf(".")!==-1;if(l)n=a.split("."),a=n.shift(),e.member=n.shift();else if(o){const c=a.split("(");a=c.shift();for(let d=0;d<c.length;d++)c[d]=parseInt(c[d].replace(/\)/,""));e.indices=c}return e.id=i,e.sid=a,e.arraySyntax=o,e.memberSyntax=l,e.sampler=T(t.getAttribute("source")),e}function fe(t){const e=[],s=t.channels,n=t.samplers,i=t.sources;for(const a in s)if(s.hasOwnProperty(a)){const o=s[a],l=n[o.sampler],c=l.inputs.INPUT,d=l.inputs.OUTPUT,p=i[c],r=i[d],b=ne(o,p,r);q(b,e)}return e}function Y(t){return z(w.animations[t],fe)}function ne(t,e,s){const n=w.nodes[t.id],i=be(n.id),a=n.transforms[t.sid],o=n.matrix.clone().transpose();let l,c,d,p,r,b;const f={};switch(a){case"matrix":for(d=0,p=e.array.length;d<p;d++)if(l=e.array[d],c=d*s.stride,f[l]===void 0&&(f[l]={}),t.arraySyntax===!0){const j=s.array[c],v=t.indices[0]+4*t.indices[1];f[l][v]=j}else for(r=0,b=s.stride;r<b;r++)f[l][r]=s.array[c+r];break;case"translate":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',a);break;case"rotate":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',a);break;case"scale":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',a);break}const g=Ae(f,o);return{name:i.uuid,keyframes:g}}function Ae(t,e){const s=[];for(const i in t)s.push({time:parseFloat(i),value:t[i]});s.sort(n);for(let i=0;i<16;i++)he(s,i,e.elements[i]);return s;function n(i,a){return i.time-a.time}}const oe=new ae,R=new ae,M=new vn;function q(t,e){const s=t.keyframes,n=t.name,i=[],a=[],o=[],l=[];for(let c=0,d=s.length;c<d;c++){const p=s[c],r=p.time,b=p.value;X.fromArray(b).transpose(),X.decompose(oe,M,R),i.push(r),a.push(oe.x,oe.y,oe.z),o.push(M.x,M.y,M.z,M.w),l.push(R.x,R.y,R.z)}return a.length>0&&e.push(new ct(n+".position",i,a)),o.length>0&&e.push(new Ln(n+".quaternion",i,o)),l.length>0&&e.push(new ct(n+".scale",i,l)),e}function he(t,e,s){let n,i=!0,a,o;for(a=0,o=t.length;a<o;a++)n=t[a],n.value[e]===void 0?n.value[e]=null:i=!1;if(i===!0)for(a=0,o=t.length;a<o;a++)n=t[a],n.value[e]=s;else ke(t,e)}function ke(t,e){let s,n;for(let i=0,a=t.length;i<a;i++){const o=t[i];if(o.value[e]===null){if(s=we(t,i,e),n=Te(t,i,e),s===null){o.value[e]=n.value[e];continue}if(n===null){o.value[e]=s.value[e];continue}_e(o,s,n,e)}}}function we(t,e,s){for(;e>=0;){const n=t[e];if(n.value[s]!==null)return n;e--}return null}function Te(t,e,s){for(;e<t.length;){const n=t[e];if(n.value[s]!==null)return n;e++}return null}function _e(t,e,s,n){if(s.time-e.time===0){t.value[n]=e.value[n];return}t.value[n]=(t.time-e.time)*(s.value[n]-e.value[n])/(s.time-e.time)+e.value[n]}function h(t){const e={name:t.getAttribute("id")||"default",start:parseFloat(t.getAttribute("start")||0),end:parseFloat(t.getAttribute("end")||0),animations:[]};for(let s=0,n=t.childNodes.length;s<n;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"instance_animation":e.animations.push(T(i.getAttribute("url")));break}}w.clips[t.getAttribute("id")]=e}function P(t){const e=[],s=t.name,n=t.end-t.start||-1,i=t.animations;for(let a=0,o=i.length;a<o;a++){const l=Y(i[a]);for(let c=0,d=l.length;c<d;c++)e.push(l[c])}return new rt(s,n,e)}function S(t){return z(w.clips[t],P)}function L(t){const e={};for(let s=0,n=t.childNodes.length;s<n;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"skin":e.id=T(i.getAttribute("source")),e.skin=B(i);break;case"morph":e.id=T(i.getAttribute("source")),console.warn("THREE.ColladaLoader: Morph target animation not supported yet.");break}}w.controllers[t.getAttribute("id")]=e}function B(t){const e={sources:{}};for(let s=0,n=t.childNodes.length;s<n;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"bind_shape_matrix":e.bindShapeMatrix=x(i.textContent);break;case"source":const a=i.getAttribute("id");e.sources[a]=Le(i);break;case"joints":e.joints=C(i);break;case"vertex_weights":e.vertexWeights=I(i);break}}return e}function C(t){const e={inputs:{}};for(let s=0,n=t.childNodes.length;s<n;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"input":const a=i.getAttribute("semantic"),o=T(i.getAttribute("source"));e.inputs[a]=o;break}}return e}function I(t){const e={inputs:{}};for(let s=0,n=t.childNodes.length;s<n;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"input":const a=i.getAttribute("semantic"),o=T(i.getAttribute("source")),l=parseInt(i.getAttribute("offset"));e.inputs[a]={id:o,offset:l};break;case"vcount":e.vcount=J(i.textContent);break;case"v":e.v=J(i.textContent);break}}return e}function A(t){const e={id:t.id},s=w.geometries[e.id];return t.skin!==void 0&&(e.skin=N(t.skin),s.sources.skinIndices=e.skin.indices,s.sources.skinWeights=e.skin.weights),e}function N(t){const s={joints:[],indices:{array:[],stride:4},weights:{array:[],stride:4}},n=t.sources,i=t.vertexWeights,a=i.vcount,o=i.v,l=i.inputs.JOINT.offset,c=i.inputs.WEIGHT.offset,d=t.sources[t.joints.inputs.JOINT],p=t.sources[t.joints.inputs.INV_BIND_MATRIX],r=n[i.inputs.WEIGHT.id].array;let b=0,f,g,m;for(f=0,m=a.length;f<m;f++){const v=a[f],_=[];for(g=0;g<v;g++){const E=o[b+l],se=o[b+c],K=r[se];_.push({index:E,weight:K}),b+=2}for(_.sort(j),g=0;g<4;g++){const E=_[g];E!==void 0?(s.indices.array.push(E.index),s.weights.array.push(E.weight)):(s.indices.array.push(0),s.weights.array.push(0))}}for(t.bindShapeMatrix?s.bindMatrix=new ie().fromArray(t.bindShapeMatrix).transpose():s.bindMatrix=new ie().identity(),f=0,m=d.array.length;f<m;f++){const v=d.array[f],_=new ie().fromArray(p.array,f*p.stride).transpose();s.joints.push({name:v,boneInverse:_})}return s;function j(v,_){return _.weight-v.weight}}function y(t){return z(w.controllers[t],A)}function u(t){const e={init_from:O(t,"init_from")[0].textContent};w.images[t.getAttribute("id")]=e}function k(t){return t.build!==void 0?t.build:t.init_from}function G(t){const e=w.images[t];return e!==void 0?z(e,k):(console.warn("THREE.ColladaLoader: Couldn't find image with ID:",t),null)}function Z(t){const e={};for(let s=0,n=t.childNodes.length;s<n;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"profile_COMMON":e.profile=pe(i);break}}w.effects[t.getAttribute("id")]=e}function pe(t){const e={surfaces:{},samplers:{}};for(let s=0,n=t.childNodes.length;s<n;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"newparam":yt(i,e);break;case"technique":e.technique=Nt(i);break;case"extra":e.extra=Be(i);break}}return e}function yt(t,e){const s=t.getAttribute("sid");for(let n=0,i=t.childNodes.length;n<i;n++){const a=t.childNodes[n];if(a.nodeType===1)switch(a.nodeName){case"surface":e.surfaces[s]=kt(a);break;case"sampler2D":e.samplers[s]=wt(a);break}}}function kt(t){const e={};for(let s=0,n=t.childNodes.length;s<n;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"init_from":e.init_from=i.textContent;break}}return e}function wt(t){const e={};for(let s=0,n=t.childNodes.length;s<n;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"source":e.source=i.textContent;break}}return e}function Nt(t){const e={};for(let s=0,n=t.childNodes.length;s<n;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"constant":case"lambert":case"blinn":case"phong":e.type=i.nodeName,e.parameters=At(i);break;case"extra":e.extra=Be(i);break}}return e}function At(t){const e={};for(let s=0,n=t.childNodes.length;s<n;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"emission":case"diffuse":case"specular":case"bump":case"ambient":case"shininess":case"transparency":e[i.nodeName]=qe(i);break;case"transparent":e[i.nodeName]={opaque:i.hasAttribute("opaque")?i.getAttribute("opaque"):"A_ONE",data:qe(i)};break}}return e}function qe(t){const e={};for(let s=0,n=t.childNodes.length;s<n;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"color":e[i.nodeName]=x(i.textContent);break;case"float":e[i.nodeName]=parseFloat(i.textContent);break;case"texture":e[i.nodeName]={id:i.getAttribute("texture"),extra:Pe(i)};break}}return e}function Pe(t){const e={technique:{}};for(let s=0,n=t.childNodes.length;s<n;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"extra":Tt(i,e);break}}return e}function Tt(t,e){for(let s=0,n=t.childNodes.length;s<n;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"technique":_t(i,e);break}}}function _t(t,e){for(let s=0,n=t.childNodes.length;s<n;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"repeatU":case"repeatV":case"offsetU":case"offsetV":e.technique[i.nodeName]=parseFloat(i.textContent);break;case"wrapU":case"wrapV":i.textContent.toUpperCase()==="TRUE"?e.technique[i.nodeName]=1:i.textContent.toUpperCase()==="FALSE"?e.technique[i.nodeName]=0:e.technique[i.nodeName]=parseInt(i.textContent);break;case"bump":e[i.nodeName]=He(i);break}}}function Be(t){const e={};for(let s=0,n=t.childNodes.length;s<n;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"technique":e.technique=Et(i);break}}return e}function Et(t){const e={};for(let s=0,n=t.childNodes.length;s<n;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"double_sided":e[i.nodeName]=parseInt(i.textContent);break;case"bump":e[i.nodeName]=He(i);break}}return e}function He(t){const e={};for(let s=0,n=t.childNodes.length;s<n;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"texture":e[i.nodeName]={id:i.getAttribute("texture"),texcoord:i.getAttribute("texcoord"),extra:Pe(i)};break}}return e}function Ue(t){return t}function xt(t){return z(w.effects[t],Ue)}function Ct(t){const e={name:t.getAttribute("name")};for(let s=0,n=t.childNodes.length;s<n;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"instance_effect":e.url=T(i.getAttribute("url"));break}}w.materials[t.getAttribute("id")]=e}function vt(t){let e,s=t.slice((t.lastIndexOf(".")-1>>>0)+2);switch(s=s.toLowerCase(),s){case"tga":e=Se;break;default:e=st}return e}function ze(t){const e=xt(t.url),s=e.profile.technique;let n;switch(s.type){case"phong":case"blinn":n=new lt;break;case"lambert":n=new In;break;default:n=new ot;break}n.name=t.name||"";function i(c,d=null){const p=e.profile.samplers[c.id];let r=null;if(p!==void 0){const b=e.profile.surfaces[p.source];r=G(b.init_from)}else console.warn("THREE.ColladaLoader: Undefined sampler. Access image directly (see #12530)."),r=G(c.id);if(r!==null){const b=vt(r);if(b!==void 0){const f=b.load(r),g=c.extra;if(g!==void 0&&g.technique!==void 0&&D(g.technique)===!1){const m=g.technique;f.wrapS=m.wrapU?ve:ut,f.wrapT=m.wrapV?ve:ut,f.offset.set(m.offsetU||0,m.offsetV||0),f.repeat.set(m.repeatU||1,m.repeatV||1)}else f.wrapS=ve,f.wrapT=ve;return d!==null&&(f.encoding=d),f}else return console.warn("THREE.ColladaLoader: Loader for texture %s not found.",r),null}else return console.warn("THREE.ColladaLoader: Couldn't create texture with ID:",c.id),null}const a=s.parameters;for(const c in a){const d=a[c];switch(c){case"diffuse":d.color&&n.color.fromArray(d.color),d.texture&&(n.map=i(d.texture,Ge));break;case"specular":d.color&&n.specular&&n.specular.fromArray(d.color),d.texture&&(n.specularMap=i(d.texture));break;case"bump":d.texture&&(n.normalMap=i(d.texture));break;case"ambient":d.texture&&(n.lightMap=i(d.texture,Ge));break;case"shininess":d.float&&n.shininess&&(n.shininess=d.float);break;case"emission":d.color&&n.emissive&&n.emissive.fromArray(d.color),d.texture&&(n.emissiveMap=i(d.texture,Ge));break}}n.color.convertSRGBToLinear(),n.specular&&n.specular.convertSRGBToLinear(),n.emissive&&n.emissive.convertSRGBToLinear();let o=a.transparent,l=a.transparency;if(l===void 0&&o&&(l={float:1}),o===void 0&&l&&(o={opaque:"A_ONE",data:{color:[1,1,1,1]}}),o&&l)if(o.data.texture)n.transparent=!0;else{const c=o.data.color;switch(o.opaque){case"A_ONE":n.opacity=c[3]*l.float;break;case"RGB_ZERO":n.opacity=1-c[0]*l.float;break;case"A_ZERO":n.opacity=1-c[3]*l.float;break;case"RGB_ONE":n.opacity=c[0]*l.float;break;default:console.warn('THREE.ColladaLoader: Invalid opaque type "%s" of transparent tag.',o.opaque)}n.opacity<1&&(n.transparent=!0)}if(s.extra!==void 0&&s.extra.technique!==void 0){const c=s.extra.technique;for(const d in c){const p=c[d];switch(d){case"double_sided":n.side=p===1?Sn:Gn;break;case"bump":n.normalMap=i(p.texture),n.normalScale=new Rn(1,1);break}}}return n}function Lt(t){return z(w.materials[t],ze)}function It(t){const e={name:t.getAttribute("name")};for(let s=0,n=t.childNodes.length;s<n;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"optics":e.optics=Rt(i);break}}w.cameras[t.getAttribute("id")]=e}function Rt(t){for(let e=0;e<t.childNodes.length;e++){const s=t.childNodes[e];switch(s.nodeName){case"technique_common":return St(s)}}return{}}function St(t){const e={};for(let s=0;s<t.childNodes.length;s++){const n=t.childNodes[s];switch(n.nodeName){case"perspective":case"orthographic":e.technique=n.nodeName,e.parameters=Gt(n);break}}return e}function Gt(t){const e={};for(let s=0;s<t.childNodes.length;s++){const n=t.childNodes[s];switch(n.nodeName){case"xfov":case"yfov":case"xmag":case"ymag":case"znear":case"zfar":case"aspect_ratio":e[n.nodeName]=parseFloat(n.textContent);break}}return e}function Fe(t){let e;switch(t.optics.technique){case"perspective":e=new Oe(t.optics.parameters.yfov,t.optics.parameters.aspect_ratio,t.optics.parameters.znear,t.optics.parameters.zfar);break;case"orthographic":let s=t.optics.parameters.ymag,n=t.optics.parameters.xmag;const i=t.optics.parameters.aspect_ratio;n=n===void 0?s*i:n,s=s===void 0?n/i:s,n*=.5,s*=.5,e=new Mn(-n,n,s,-s,t.optics.parameters.znear,t.optics.parameters.zfar);break;default:e=new Oe;break}return e.name=t.name||"",e}function Mt(t){const e=w.cameras[t];return e!==void 0?z(e,Fe):(console.warn("THREE.ColladaLoader: Couldn't find camera with ID:",t),null)}function Ot(t){let e={};for(let s=0,n=t.childNodes.length;s<n;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"technique_common":e=jt(i);break}}w.lights[t.getAttribute("id")]=e}function jt(t){const e={};for(let s=0,n=t.childNodes.length;s<n;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"directional":case"point":case"spot":case"ambient":e.technique=i.nodeName,e.parameters=qt(i)}}return e}function qt(t){const e={};for(let s=0,n=t.childNodes.length;s<n;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"color":const a=x(i.textContent);e.color=new Me().fromArray(a).convertSRGBToLinear();break;case"falloff_angle":e.falloffAngle=parseFloat(i.textContent);break;case"quadratic_attenuation":const o=parseFloat(i.textContent);e.distance=o?Math.sqrt(1/o):0;break}}return e}function Ve(t){let e;switch(t.technique){case"directional":e=new jn;break;case"point":e=new gt;break;case"spot":e=new On;break;case"ambient":e=new bt;break}return t.parameters.color&&e.color.copy(t.parameters.color),t.parameters.distance&&(e.distance=t.parameters.distance),e}function Pt(t){const e=w.lights[t];return e!==void 0?z(e,Ve):(console.warn("THREE.ColladaLoader: Couldn't find light with ID:",t),null)}function Bt(t){const e={name:t.getAttribute("name"),sources:{},vertices:{},primitives:[]},s=O(t,"mesh")[0];if(s!==void 0){for(let n=0;n<s.childNodes.length;n++){const i=s.childNodes[n];if(i.nodeType!==1)continue;const a=i.getAttribute("id");switch(i.nodeName){case"source":e.sources[a]=Le(i);break;case"vertices":e.vertices=Ht(i);break;case"polygons":console.warn("THREE.ColladaLoader: Unsupported primitive type: ",i.nodeName);break;case"lines":case"linestrips":case"polylist":case"triangles":e.primitives.push(Ut(i));break;default:console.log(i)}}w.geometries[t.getAttribute("id")]=e}}function Le(t){const e={array:[],stride:3};for(let s=0;s<t.childNodes.length;s++){const n=t.childNodes[s];if(n.nodeType===1)switch(n.nodeName){case"float_array":e.array=x(n.textContent);break;case"Name_array":e.array=W(n.textContent);break;case"technique_common":const i=O(n,"accessor")[0];i!==void 0&&(e.stride=parseInt(i.getAttribute("stride")));break}}return e}function Ht(t){const e={};for(let s=0;s<t.childNodes.length;s++){const n=t.childNodes[s];n.nodeType===1&&(e[n.getAttribute("semantic")]=T(n.getAttribute("source")))}return e}function Ut(t){const e={type:t.nodeName,material:t.getAttribute("material"),count:parseInt(t.getAttribute("count")),inputs:{},stride:0,hasUV:!1};for(let s=0,n=t.childNodes.length;s<n;s++){const i=t.childNodes[s];if(i.nodeType===1)switch(i.nodeName){case"input":const a=T(i.getAttribute("source")),o=i.getAttribute("semantic"),l=parseInt(i.getAttribute("offset")),c=parseInt(i.getAttribute("set")),d=c>0?o+c:o;e.inputs[d]={id:a,offset:l},e.stride=Math.max(e.stride,l+1),o==="TEXCOORD"&&(e.hasUV=!0);break;case"vcount":e.vcount=J(i.textContent);break;case"p":e.p=J(i.textContent);break}}return e}function zt(t){const e={};for(let s=0;s<t.length;s++){const n=t[s];e[n.type]===void 0&&(e[n.type]=[]),e[n.type].push(n)}return e}function Ft(t){let e=0;for(let s=0,n=t.length;s<n;s++)t[s].hasUV===!0&&e++;e>0&&e<t.length&&(t.uvsNeedsFix=!0)}function De(t){const e={},s=t.sources,n=t.vertices,i=t.primitives;if(i.length===0)return{};const a=zt(i);for(const o in a){const l=a[o];Ft(l),e[o]=Vt(l,s,n)}return e}function Vt(t,e,s){const n={},i={array:[],stride:0},a={array:[],stride:0},o={array:[],stride:0},l={array:[],stride:0},c={array:[],stride:0},d={array:[],stride:4},p={array:[],stride:4},r=new qn,b=[];let f=0;for(let g=0;g<t.length;g++){const m=t[g],j=m.inputs;let v=0;switch(m.type){case"lines":case"linestrips":v=m.count*2;break;case"triangles":v=m.count*3;break;case"polylist":for(let _=0;_<m.count;_++){const E=m.vcount[_];switch(E){case 3:v+=3;break;case 4:v+=6;break;default:v+=(E-2)*3;break}}break;default:console.warn("THREE.ColladaLoader: Unknow primitive type:",m.type)}r.addGroup(f,v,g),f+=v,m.material&&b.push(m.material);for(const _ in j){const E=j[_];switch(_){case"VERTEX":for(const se in s){const K=s[se];switch(se){case"POSITION":const ge=i.array.length;if($(m,e[K],E.offset,i.array),i.stride=e[K].stride,e.skinWeights&&e.skinIndices&&($(m,e.skinIndices,E.offset,d.array),$(m,e.skinWeights,E.offset,p.array)),m.hasUV===!1&&t.uvsNeedsFix===!0){const wn=(i.array.length-ge)/i.stride;for(let at=0;at<wn;at++)o.array.push(0,0)}break;case"NORMAL":$(m,e[K],E.offset,a.array),a.stride=e[K].stride;break;case"COLOR":$(m,e[K],E.offset,c.array),c.stride=e[K].stride;break;case"TEXCOORD":$(m,e[K],E.offset,o.array),o.stride=e[K].stride;break;case"TEXCOORD1":$(m,e[K],E.offset,l.array),o.stride=e[K].stride;break;default:console.warn('THREE.ColladaLoader: Semantic "%s" not handled in geometry build process.',se)}}break;case"NORMAL":$(m,e[E.id],E.offset,a.array),a.stride=e[E.id].stride;break;case"COLOR":$(m,e[E.id],E.offset,c.array,!0),c.stride=e[E.id].stride;break;case"TEXCOORD":$(m,e[E.id],E.offset,o.array),o.stride=e[E.id].stride;break;case"TEXCOORD1":$(m,e[E.id],E.offset,l.array),l.stride=e[E.id].stride;break}}}return i.array.length>0&&r.setAttribute("position",new ce(i.array,i.stride)),a.array.length>0&&r.setAttribute("normal",new ce(a.array,a.stride)),c.array.length>0&&r.setAttribute("color",new ce(c.array,c.stride)),o.array.length>0&&r.setAttribute("uv",new ce(o.array,o.stride)),l.array.length>0&&r.setAttribute("uv2",new ce(l.array,l.stride)),d.array.length>0&&r.setAttribute("skinIndex",new ce(d.array,d.stride)),p.array.length>0&&r.setAttribute("skinWeight",new ce(p.array,p.stride)),n.data=r,n.type=t[0].type,n.materialKeys=b,n}function $(t,e,s,n,i=!1){const a=t.p,o=t.stride,l=t.vcount;function c(r){let b=a[r+s]*p;const f=b+p;for(;b<f;b++)n.push(d[b]);if(i){const g=n.length-p-1;Ee.setRGB(n[g+0],n[g+1],n[g+2]).convertSRGBToLinear(),n[g+0]=Ee.r,n[g+1]=Ee.g,n[g+2]=Ee.b}}const d=e.array,p=e.stride;if(t.vcount!==void 0){let r=0;for(let b=0,f=l.length;b<f;b++){const g=l[b];if(g===4){const m=r+o*0,j=r+o*1,v=r+o*2,_=r+o*3;c(m),c(j),c(_),c(j),c(v),c(_)}else if(g===3){const m=r+o*0,j=r+o*1,v=r+o*2;c(m),c(j),c(v)}else if(g>4)for(let m=1,j=g-2;m<=j;m++){const v=r+o*0,_=r+o*m,E=r+o*(m+1);c(v),c(_),c(E)}r+=o*g}}else for(let r=0,b=a.length;r<b;r+=o)c(r)}function Ke(t){return z(w.geometries[t],De)}function Dt(t){const e={name:t.getAttribute("name")||"",joints:{},links:[]};for(let s=0;s<t.childNodes.length;s++){const n=t.childNodes[s];if(n.nodeType===1)switch(n.nodeName){case"technique_common":Jt(n,e);break}}w.kinematicsModels[t.getAttribute("id")]=e}function Kt(t){return t.build!==void 0?t.build:t}function Wt(t){return z(w.kinematicsModels[t],Kt)}function Jt(t,e){for(let s=0;s<t.childNodes.length;s++){const n=t.childNodes[s];if(n.nodeType===1)switch(n.nodeName){case"joint":e.joints[n.getAttribute("sid")]=Yt(n);break;case"link":e.links.push(We(n));break}}}function Yt(t){let e;for(let s=0;s<t.childNodes.length;s++){const n=t.childNodes[s];if(n.nodeType===1)switch(n.nodeName){case"prismatic":case"revolute":e=Xt(n);break}}return e}function Xt(t){const e={sid:t.getAttribute("sid"),name:t.getAttribute("name")||"",axis:new ae,limits:{min:0,max:0},type:t.nodeName,static:!1,zeroPosition:0,middlePosition:0};for(let s=0;s<t.childNodes.length;s++){const n=t.childNodes[s];if(n.nodeType===1)switch(n.nodeName){case"axis":const i=x(n.textContent);e.axis.fromArray(i);break;case"limits":const a=n.getElementsByTagName("max")[0],o=n.getElementsByTagName("min")[0];e.limits.max=parseFloat(a.textContent),e.limits.min=parseFloat(o.textContent);break}}return e.limits.min>=e.limits.max&&(e.static=!0),e.middlePosition=(e.limits.min+e.limits.max)/2,e}function We(t){const e={sid:t.getAttribute("sid"),name:t.getAttribute("name")||"",attachments:[],transforms:[]};for(let s=0;s<t.childNodes.length;s++){const n=t.childNodes[s];if(n.nodeType===1)switch(n.nodeName){case"attachment_full":e.attachments.push(Zt(n));break;case"matrix":case"translate":case"rotate":e.transforms.push(Je(n));break}}return e}function Zt(t){const e={joint:t.getAttribute("joint").split("/").pop(),transforms:[],links:[]};for(let s=0;s<t.childNodes.length;s++){const n=t.childNodes[s];if(n.nodeType===1)switch(n.nodeName){case"link":e.links.push(We(n));break;case"matrix":case"translate":case"rotate":e.transforms.push(Je(n));break}}return e}function Je(t){const e={type:t.nodeName},s=x(t.textContent);switch(e.type){case"matrix":e.obj=new ie,e.obj.fromArray(s).transpose();break;case"translate":e.obj=new ae,e.obj.fromArray(s);break;case"rotate":e.obj=new ae,e.obj.fromArray(s),e.angle=Ne.degToRad(s[3]);break}return e}function Qt(t){const e={name:t.getAttribute("name")||"",rigidBodies:{}};for(let s=0;s<t.childNodes.length;s++){const n=t.childNodes[s];if(n.nodeType===1)switch(n.nodeName){case"rigid_body":e.rigidBodies[n.getAttribute("name")]={},$t(n,e.rigidBodies[n.getAttribute("name")]);break}}w.physicsModels[t.getAttribute("id")]=e}function $t(t,e){for(let s=0;s<t.childNodes.length;s++){const n=t.childNodes[s];if(n.nodeType===1)switch(n.nodeName){case"technique_common":en(n,e);break}}}function en(t,e){for(let s=0;s<t.childNodes.length;s++){const n=t.childNodes[s];if(n.nodeType===1)switch(n.nodeName){case"inertia":e.inertia=x(n.textContent);break;case"mass":e.mass=x(n.textContent)[0];break}}}function tn(t){const e={bindJointAxis:[]};for(let s=0;s<t.childNodes.length;s++){const n=t.childNodes[s];if(n.nodeType===1)switch(n.nodeName){case"bind_joint_axis":e.bindJointAxis.push(nn(n));break}}w.kinematicsScenes[T(t.getAttribute("url"))]=e}function nn(t){const e={target:t.getAttribute("target").split("/").pop()};for(let s=0;s<t.childNodes.length;s++){const n=t.childNodes[s];if(n.nodeType===1)switch(n.nodeName){case"axis":const i=n.getElementsByTagName("param")[0];e.axis=i.textContent;const a=e.axis.split("inst_").pop().split("axis")[0];e.jointIndex=a.substring(0,a.length-1);break}}return e}function sn(t){return t.build!==void 0?t.build:t}function an(t){return z(w.kinematicsScenes[t],sn)}function on(){const t=Object.keys(w.kinematicsModels)[0],e=Object.keys(w.kinematicsScenes)[0],s=Object.keys(w.visualScenes)[0];if(t===void 0||e===void 0)return;const n=Wt(t),i=an(e),a=et(s),o=i.bindJointAxis,l={};for(let p=0,r=o.length;p<r;p++){const b=o[p],f=U.querySelector('[sid="'+b.target+'"]');if(f){const g=f.parentElement;c(b.jointIndex,g)}}function c(p,r){const b=r.getAttribute("name"),f=n.joints[p];a.traverse(function(g){g.name===b&&(l[p]={object:g,transforms:rn(r),joint:f,position:f.zeroPosition})})}const d=new ie;it={joints:n&&n.joints,getJointValue:function(p){const r=l[p];if(r)return r.position;console.warn("THREE.ColladaLoader: Joint "+p+" doesn't exist.")},setJointValue:function(p,r){const b=l[p];if(b){const f=b.joint;if(r>f.limits.max||r<f.limits.min)console.warn("THREE.ColladaLoader: Joint "+p+" value "+r+" outside of limits (min: "+f.limits.min+", max: "+f.limits.max+").");else if(f.static)console.warn("THREE.ColladaLoader: Joint "+p+" is static.");else{const g=b.object,m=f.axis,j=b.transforms;X.identity();for(let v=0;v<j.length;v++){const _=j[v];if(_.sid&&_.sid.indexOf(p)!==-1)switch(f.type){case"revolute":X.multiply(d.makeRotationAxis(m,Ne.degToRad(r)));break;case"prismatic":X.multiply(d.makeTranslation(m.x*r,m.y*r,m.z*r));break;default:console.warn("THREE.ColladaLoader: Unknown joint type: "+f.type);break}else switch(_.type){case"matrix":X.multiply(_.obj);break;case"translate":X.multiply(d.makeTranslation(_.obj.x,_.obj.y,_.obj.z));break;case"scale":X.scale(_.obj);break;case"rotate":X.multiply(d.makeRotationAxis(_.obj,_.angle));break}}g.matrix.copy(X),g.matrix.decompose(g.position,g.quaternion,g.scale),l[p].position=r}}else console.log("THREE.ColladaLoader: "+p+" does not exist.")}}}function rn(t){const e=[],s=U.querySelector('[id="'+t.id+'"]');for(let n=0;n<s.childNodes.length;n++){const i=s.childNodes[n];if(i.nodeType!==1)continue;let a,o;switch(i.nodeName){case"matrix":a=x(i.textContent);const l=new ie().fromArray(a).transpose();e.push({sid:i.getAttribute("sid"),type:i.nodeName,obj:l});break;case"translate":case"scale":a=x(i.textContent),o=new ae().fromArray(a),e.push({sid:i.getAttribute("sid"),type:i.nodeName,obj:o});break;case"rotate":a=x(i.textContent),o=new ae().fromArray(a);const c=Ne.degToRad(a[3]);e.push({sid:i.getAttribute("sid"),type:i.nodeName,obj:o,angle:c});break}}return e}function cn(t){const e=t.getElementsByTagName("node");for(let s=0;s<e.length;s++){const n=e[s];n.hasAttribute("id")===!1&&n.setAttribute("id",Q())}}const X=new ie,me=new ae;function Ie(t){const e={name:t.getAttribute("name")||"",type:t.getAttribute("type"),id:t.getAttribute("id"),sid:t.getAttribute("sid"),matrix:new ie,nodes:[],instanceCameras:[],instanceControllers:[],instanceLights:[],instanceGeometries:[],instanceNodes:[],transforms:{}};for(let s=0;s<t.childNodes.length;s++){const n=t.childNodes[s];if(n.nodeType!==1)continue;let i;switch(n.nodeName){case"node":e.nodes.push(n.getAttribute("id")),Ie(n);break;case"instance_camera":e.instanceCameras.push(T(n.getAttribute("url")));break;case"instance_controller":e.instanceControllers.push(Ye(n));break;case"instance_light":e.instanceLights.push(T(n.getAttribute("url")));break;case"instance_geometry":e.instanceGeometries.push(Ye(n));break;case"instance_node":e.instanceNodes.push(T(n.getAttribute("url")));break;case"matrix":i=x(n.textContent),e.matrix.multiply(X.fromArray(i).transpose()),e.transforms[n.getAttribute("sid")]=n.nodeName;break;case"translate":i=x(n.textContent),me.fromArray(i),e.matrix.multiply(X.makeTranslation(me.x,me.y,me.z)),e.transforms[n.getAttribute("sid")]=n.nodeName;break;case"rotate":i=x(n.textContent);const a=Ne.degToRad(i[3]);e.matrix.multiply(X.makeRotationAxis(me.fromArray(i),a)),e.transforms[n.getAttribute("sid")]=n.nodeName;break;case"scale":i=x(n.textContent),e.matrix.scale(me.fromArray(i)),e.transforms[n.getAttribute("sid")]=n.nodeName;break;case"extra":break;default:console.log(n)}}return Qe(e.id)?console.warn("THREE.ColladaLoader: There is already a node with ID %s. Exclude current node from further processing.",e.id):w.nodes[e.id]=e,e}function Ye(t){const e={id:T(t.getAttribute("url")),materials:{},skeletons:[]};for(let s=0;s<t.childNodes.length;s++){const n=t.childNodes[s];switch(n.nodeName){case"bind_material":const i=n.getElementsByTagName("instance_material");for(let a=0;a<i.length;a++){const o=i[a],l=o.getAttribute("symbol"),c=o.getAttribute("target");e.materials[l]=T(c)}break;case"skeleton":e.skeletons.push(T(n.textContent));break}}return e}function ln(t,e){const s=[],n=[];let i,a,o;for(i=0;i<t.length;i++){const d=t[i];let p;if(Qe(d))p=be(d),Xe(p,e,s);else if(pn(d)){const b=w.visualScenes[d].children;for(let f=0;f<b.length;f++){const g=b[f];if(g.type==="JOINT"){const m=be(g.id);Xe(m,e,s)}}}else console.error("THREE.ColladaLoader: Unable to find root bone of skeleton with ID:",d)}for(i=0;i<e.length;i++)for(a=0;a<s.length;a++)if(o=s[a],o.bone.name===e[i].name){n[i]=o,o.processed=!0;break}for(i=0;i<s.length;i++)o=s[i],o.processed===!1&&(n.push(o),o.processed=!0);const l=[],c=[];for(i=0;i<n.length;i++)o=n[i],l.push(o.bone),c.push(o.boneInverse);return new Vn(l,c)}function Xe(t,e,s){t.traverse(function(n){if(n.isBone===!0){let i;for(let a=0;a<e.length;a++){const o=e[a];if(o.name===n.name){i=o.boneInverse;break}}i===void 0&&(i=new ie),s.push({bone:n,boneInverse:i,processed:!1})}})}function dn(t){const e=[],s=t.matrix,n=t.nodes,i=t.type,a=t.instanceCameras,o=t.instanceControllers,l=t.instanceLights,c=t.instanceGeometries,d=t.instanceNodes;for(let r=0,b=n.length;r<b;r++)e.push(be(n[r]));for(let r=0,b=a.length;r<b;r++){const f=Mt(a[r]);f!==null&&e.push(f.clone())}for(let r=0,b=o.length;r<b;r++){const f=o[r],g=y(f.id),m=Ke(g.id),j=Ze(m,f.materials),v=f.skeletons,_=g.skin.joints,E=ln(v,_);for(let se=0,K=j.length;se<K;se++){const ge=j[se];ge.isSkinnedMesh&&(ge.bind(E,g.skin.bindMatrix),ge.normalizeSkinWeights()),e.push(ge)}}for(let r=0,b=l.length;r<b;r++){const f=Pt(l[r]);f!==null&&e.push(f.clone())}for(let r=0,b=c.length;r<b;r++){const f=c[r],g=Ke(f.id),m=Ze(g,f.materials);for(let j=0,v=m.length;j<v;j++)e.push(m[j])}for(let r=0,b=d.length;r<b;r++)e.push(be(d[r]).clone());let p;if(n.length===0&&e.length===1)p=e[0];else{p=i==="JOINT"?new Pn:new dt;for(let r=0;r<e.length;r++)p.add(e[r])}return p.name=i==="JOINT"?t.sid:t.name,p.matrix.copy(s),p.matrix.decompose(p.position,p.quaternion,p.scale),p}const un=new ot({color:16711935});function fn(t,e){const s=[];for(let n=0,i=t.length;n<i;n++){const a=e[t[n]];a===void 0?(console.warn("THREE.ColladaLoader: Material with key %s not found. Apply fallback material.",t[n]),s.push(un)):s.push(Lt(a))}return s}function Ze(t,e){const s=[];for(const n in t){const i=t[n],a=fn(i.materialKeys,e);a.length===0&&(n==="lines"||n==="linestrips"?a.push(new Bn):a.push(new lt));const o=i.data.attributes.skinIndex!==void 0,l=a.length===1?a[0]:a;let c;switch(n){case"lines":c=new Fn(i.data,l);break;case"linestrips":c=new zn(i.data,l);break;case"triangles":case"polylist":o?c=new Hn(i.data,l):c=new Un(i.data,l);break}s.push(c)}return s}function Qe(t){return w.nodes[t]!==void 0}function be(t){return z(w.nodes[t],dn)}function hn(t){const e={name:t.getAttribute("name"),children:[]};cn(t);const s=O(t,"node");for(let n=0;n<s.length;n++)e.children.push(Ie(s[n]));w.visualScenes[t.getAttribute("id")]=e}function $e(t){const e=new dt;e.name=t.name;const s=t.children;for(let n=0;n<s.length;n++){const i=s[n];e.add(be(i.id))}return e}function pn(t){return w.visualScenes[t]!==void 0}function et(t){return z(w.visualScenes[t],$e)}function mn(t){const e=O(t,"instance_visual_scene")[0];return et(T(e.getAttribute("url")))}function bn(){const t=w.clips;if(D(t)===!0){if(D(w.animations)===!1){const e=[];for(const s in w.animations){const n=Y(s);for(let i=0,a=n.length;i<a;i++)e.push(n[i])}xe.push(new rt("default",-1,e))}}else for(const e in t)xe.push(S(e))}function gn(t){let e="";const s=[t];for(;s.length;){const n=s.shift();n.nodeType===Node.TEXT_NODE?e+=n.textContent:(e+=`
`,s.push.apply(s,n.childNodes))}return e.trim()}if(F.length===0)return{scene:new mt};const tt=new DOMParser().parseFromString(F,"application/xml"),U=O(tt,"COLLADA")[0],Re=tt.getElementsByTagName("parsererror")[0];if(Re!==void 0){const t=O(Re,"div")[0];let e;return t?e=t.textContent:e=gn(Re),console.error(`THREE.ColladaLoader: Failed to parse collada file.
`,e),null}const yn=U.getAttribute("version");console.log("THREE.ColladaLoader: File version",yn);const nt=te(O(U,"asset")[0]),st=new xn(this.manager);st.setPath(this.resourcePath||ee).setCrossOrigin(this.crossOrigin);let Se;pt&&(Se=new pt(this.manager),Se.setPath(this.resourcePath||ee));const Ee=new Me,xe=[];let it={},kn=0;const w={animations:{},clips:{},controllers:{},images:{},effects:{},materials:{},cameras:{},lights:{},geometries:{},nodes:{},visualScenes:{},kinematicsModels:{},physicsModels:{},kinematicsScenes:{}};H(U,"library_animations","animation",re),H(U,"library_animation_clips","animation_clip",h),H(U,"library_controllers","controller",L),H(U,"library_images","image",u),H(U,"library_effects","effect",Z),H(U,"library_materials","material",Ct),H(U,"library_cameras","camera",It),H(U,"library_lights","light",Ot),H(U,"library_geometries","geometry",Bt),H(U,"library_nodes","node",Ie),H(U,"library_visual_scenes","visual_scene",hn),H(U,"library_kinematics_models","kinematics_model",Dt),H(U,"library_physics_models","physics_model",Qt),H(U,"scene","instance_kinematics_scene",tn),V(w.animations,fe),V(w.clips,P),V(w.controllers,A),V(w.images,k),V(w.effects,Ue),V(w.materials,ze),V(w.cameras,Fe),V(w.lights,Ve),V(w.geometries,De),V(w.visualScenes,$e),bn(),on();const Ce=mn(O(U,"scene")[0]);return Ce.animations=xe,nt.upAxis==="Z_UP"&&(console.warn("THREE.ColladaLoader: You are loading an asset with a Z-UP coordinate system. The loader just rotates the asset to transform it into Y-UP. The vertex data are not converted, see #24289."),Ce.quaternion.setFromEuler(new Cn(-Math.PI/2,0,0))),Ce.scale.multiplyScalar(nt.unit),{get animations(){return console.warn("THREE.ColladaLoader: Please access animations over scene.animations now."),xe},kinematics:it,library:w,scene:Ce}}}const ns={class:"viewCon"},os=Xn({__name:"08-load-collada",setup(je){const F=ft(),ee=ft();let O=window.innerWidth,W=window.innerHeight,x,J,T,Q,D,te;Zn(async()=>{ye(),de(),re(),await z(),ue()});function ye(){var ne;let Y=new Dn({autoPlace:!1,width:300});Y.domElement.style.cssText="position: fixed; top: 0; right: 0;",(ne=ee.value)==null||ne.appendChild(Y.domElement)}function le(){te.rotation.z+=.01}const H=new ts;function V(Y){return new Promise((ne,Ae)=>{H.load(Y,function(oe){ne(oe.scene)})})}async function z(){te=await V(es),te.scale.multiplyScalar(5),te.position.y=20,T.add(te)}function re(){const Y=new gt(16777215,2);Y.position.set(10,50,10),T.add(Y)}function de(){T=new mt,T.background=new Me(4473924),Q=new Oe(75,O/W,1,1e3),D=new Kn({canvas:F.value,antialias:!0}),D.setSize(O,W),window.addEventListener("resize",fe),T.add(new Wn(1e3)),T.add(new bt(4210752)),x=Jn(),ee.value.append(x.dom),J=new Yn(Q,D.domElement),J.target=new ae(0,40,0),J.object.position.set(0,40,60),J.update()}function ue(){requestAnimationFrame(ue),x.update(),le(),D.render(T,Q)}function fe(){O=window.innerWidth,W=window.innerHeight,Q.aspect=O/W,Q.updateProjectionMatrix(),D.setSize(O,W)}return(Y,ne)=>($n(),Qn("div",ns,[ht("div",{class:"canvasCon",ref_key:"canvasCon",ref:ee},[ht("canvas",{class:"canvas",ref_key:"canvasDom",ref:F},null,512)],512)]))}});export{os as default};
