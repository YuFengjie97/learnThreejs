import{aA as O,aN as G,aB as S,a6 as Q,R as Z,C as h,aa as R,d as g,aO as T,s as V,aP as _,G as B,D as C,o as z,S as F,P as E,W as P,A as K,a as U,b as H,V as W}from"./stats.module.c456474f.js";import{O as X}from"./OrbitControls.ff4b382f.js";import{O as Y}from"./OBJLoader.1c2fe48f.js";import{d as J,g as b,h as q,c as $,f as k,o as ee}from"./index.b9f501be.js";const te="/learning-threejs/assets/butterfly.4b656c2b.obj",se="data:model/mtl;base64,IyBCbGVuZGVyIE1UTCBGaWxlOiAnYnV0dGVyZmx5LmJsZW5kJw0KIyBNYXRlcmlhbCBDb3VudDogNA0KbmV3bXRsIGJ1dHRlcmZseV9ib2R5DQpOcyAwLjAwMDAwMA0KS2EgMC4wMDAwMDAgMC4wMDAwMDAgMC4wMDAwMDANCktkIDAuNTY0NzA2IDAuMzI5NDEyIDAuNTk5MjE2DQpLcyAwLjAwMDAwMCAwLjAwMDAwMCAwLjAwMDAwMA0KTmkgMS4wMDAwMDANCmQgMS4wMDAwMDANCmlsbHVtIDENCg0KDQpuZXdtdGwgYnV0dGVyZmx5X2V5ZXMNCk5zIDY1LjAwNzM0NA0KS2EgMC4wMDAwMDAgMC4wMDAwMDAgMC4wMDAwMDANCktkIDAuMDAwMDAwIDAuMDAwMDAwIDAuMDAwMDAwDQpLcyAyLjAwMDAwMCAyLjAwMDAwMCAyLjAwMDAwMA0KTmkgMS4wMDAwMDANCmQgMS4wMDAwMDANCmlsbHVtIDINCg0KDQpuZXdtdGwgYnV0dGVyZmx5X2xlZ3MNCk5zIDAuMDAwMDAwDQpLYSAwLjAwMDAwMCAwLjAwMDAwMCAwLjAwMDAwMA0KS2QgMC4zNzUzMjQgMC4xNTc5NTMgMC40MDIzMzMNCktzIDAuMDAwMDAwIDAuMDAwMDAwIDAuMDAwMDAwDQpOaSAxLjAwMDAwMA0KZCAxLjAwMDAwMA0KaWxsdW0gMQ0KDQoNCm5ld210bCBidXR0ZXJmbHlfd2luZ3NfYnV0dGVyZmx5d2luZ3MucG5nDQpOcyAyMS41Njg2MjcNCkthIDAuMDAwMDAwIDAuMDAwMDAwIDAuMDAwMDAwDQpLZCAwLjY2NDI4MCAwLjQ1MzE3MCAwLjc0NDI0OA0KS3MgMC4xMjQxNjUgMC4xMjQxNjUgMC4xMjQxNjUNCk5pIDEuMDAwMDAwDQpkIDAuMDAwMDAwDQppbGx1bSAyDQoNCiNjaGFuZ2UgdGhlc2UNCm1hcF9LZCBidXR0ZXJmbHl3aW5ncy5wbmcNCm1hcF9kIGJ1dHRlcmZseXdpbmdzLnBuZw0KDQoNCg==";class ae extends O{constructor(e){super(e)}load(e,r,o,t){const i=this,c=this.path===""?G.extractUrlBase(e):this.path,a=new S(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(s){try{r(i.parse(s,c))}catch(n){t?t(n):console.error(n),i.manager.itemError(e)}},o,t)}setMaterialOptions(e){return this.materialOptions=e,this}parse(e,r){const o=e.split(`
`);let t={};const i=/\s+/,c={};for(let s=0;s<o.length;s++){let n=o[s];if(n=n.trim(),n.length===0||n.charAt(0)==="#")continue;const l=n.indexOf(" ");let p=l>=0?n.substring(0,l):n;p=p.toLowerCase();let d=l>=0?n.substring(l+1):"";if(d=d.trim(),p==="newmtl")t={name:d},c[d]=t;else if(p==="ka"||p==="kd"||p==="ks"||p==="ke"){const m=d.split(i,3);t[p]=[parseFloat(m[0]),parseFloat(m[1]),parseFloat(m[2])]}else t[p]=d}const a=new ne(this.resourcePath||r,this.materialOptions);return a.setCrossOrigin(this.crossOrigin),a.setManager(this.manager),a.setMaterials(c),a}}class ne{constructor(e="",r={}){this.baseUrl=e,this.options=r,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.crossOrigin="anonymous",this.side=this.options.side!==void 0?this.options.side:Q,this.wrap=this.options.wrap!==void 0?this.options.wrap:Z}setCrossOrigin(e){return this.crossOrigin=e,this}setManager(e){this.manager=e}setMaterials(e){this.materialsInfo=this.convert(e),this.materials={},this.materialsArray=[],this.nameLookup={}}convert(e){if(!this.options)return e;const r={};for(const o in e){const t=e[o],i={};r[o]=i;for(const c in t){let a=!0,s=t[c];const n=c.toLowerCase();switch(n){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(s=[s[0]/255,s[1]/255,s[2]/255]),this.options&&this.options.ignoreZeroRGBs&&s[0]===0&&s[1]===0&&s[2]===0&&(a=!1);break}a&&(i[n]=s)}}return r}preload(){for(const e in this.materialsInfo)this.create(e)}getIndex(e){return this.nameLookup[e]}getAsArray(){let e=0;for(const r in this.materialsInfo)this.materialsArray[e]=this.create(r),this.nameLookup[r]=e,e++;return this.materialsArray}create(e){return this.materials[e]===void 0&&this.createMaterial_(e),this.materials[e]}createMaterial_(e){const r=this,o=this.materialsInfo[e],t={name:e,side:this.side};function i(a,s){return typeof s!="string"||s===""?"":/^https?:\/\//i.test(s)?s:a+s}function c(a,s){if(t[a])return;const n=r.getTextureParams(s,t),l=r.loadTexture(i(r.baseUrl,n.url));l.repeat.copy(n.scale),l.offset.copy(n.offset),l.wrapS=r.wrap,l.wrapT=r.wrap,(a==="map"||a==="emissiveMap")&&(l.encoding=_),t[a]=l}for(const a in o){const s=o[a];let n;if(s!=="")switch(a.toLowerCase()){case"kd":t.color=new h().fromArray(s).convertSRGBToLinear();break;case"ks":t.specular=new h().fromArray(s).convertSRGBToLinear();break;case"ke":t.emissive=new h().fromArray(s).convertSRGBToLinear();break;case"map_kd":c("map",s);break;case"map_ks":c("specularMap",s);break;case"map_ke":c("emissiveMap",s);break;case"norm":c("normalMap",s);break;case"map_bump":case"bump":c("bumpMap",s);break;case"map_d":c("alphaMap",s),t.transparent=!0;break;case"ns":t.shininess=parseFloat(s);break;case"d":n=parseFloat(s),n<1&&(t.opacity=n,t.transparent=!0);break;case"tr":n=parseFloat(s),this.options&&this.options.invertTrProperty&&(n=1-n),n>0&&(t.opacity=1-n,t.transparent=!0);break}}return this.materials[e]=new R(t),this.materials[e]}getTextureParams(e,r){const o={scale:new g(1,1),offset:new g(0,0)},t=e.split(/\s+/);let i;return i=t.indexOf("-bm"),i>=0&&(r.bumpScale=parseFloat(t[i+1]),t.splice(i,2)),i=t.indexOf("-s"),i>=0&&(o.scale.set(parseFloat(t[i+1]),parseFloat(t[i+2])),t.splice(i,4)),i=t.indexOf("-o"),i>=0&&(o.offset.set(parseFloat(t[i+1]),parseFloat(t[i+2])),t.splice(i,4)),o.url=t.join(" ").trim(),o}loadTexture(e,r,o,t,i){const c=this.manager!==void 0?this.manager:T;let a=c.getHandler(e);a===null&&(a=new V(c)),a.setCrossOrigin&&a.setCrossOrigin(this.crossOrigin);const s=a.load(e,o,t,i);return r!==void 0&&(s.mapping=r),s}}const ie={class:"viewCon"},pe=J({__name:"07-load-obj-mtl",setup(D){const e=b(),r=b();let o=window.innerWidth,t=window.innerHeight,i,c,a,s,n,l;q(async()=>{p(),I(),j(),await x(),f()});function p(){var M;let w=new B({autoPlace:!1,width:300});w.domElement.style.cssText="position: fixed; top: 0; right: 0;",(M=r.value)==null||M.appendChild(w.domElement)}function d(){l.rotation.y+=.01}const m=new ae,L=new Y;function y(w,M){return new Promise((A,u)=>{m.load(w,function(v){L.setMaterials(v).load(M,A)})})}async function x(){l=await y(se,te);const w=l.children[4],M=l.children[5],A=w.material,u=M.material;A.opacity=.6,A.transparent=!0,A.depthTest=!1,A.side=C,u.opacity=.6,u.depthTest=!1,u.transparent=!0,u.side=C,l.position.set(0,40,0),l.scale.multiplyScalar(100),a.add(l)}function j(){const w=new z(16777215,3);w.position.set(-10,50,0),a.add(w)}function I(){a=new F,a.background=new h(4473924),s=new E(75,o/t,1,1e3),n=new P({canvas:e.value,antialias:!0}),n.setSize(o,t),window.addEventListener("resize",N),a.add(new K(1e3)),a.add(new U(4210752)),i=H(),r.value.append(i.dom),c=new X(s,n.domElement),c.target=new W(0,40,0),c.object.position.set(0,40,60),c.update()}function f(){requestAnimationFrame(f),i.update(),d(),n.render(a,s)}function N(){o=window.innerWidth,t=window.innerHeight,s.aspect=o/t,s.updateProjectionMatrix(),n.setSize(o,t)}return(w,M)=>(ee(),$("div",ie,[k("div",{class:"canvasCon",ref_key:"canvasCon",ref:r},[k("canvas",{class:"canvas",ref_key:"canvasDom",ref:e},null,512)],512)]))}});export{pe as default};
